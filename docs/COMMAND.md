# Описание команд

<!-- TOC -->

- [actions](#) Программная среда CI/CD для платформы 1С и не только. Позволяет выполнять сборку, доставку, тестирование ПО и многое из того, что может понадобиться в DevOps
  - [autodoc](#autodoc) Автоформирование документации по этому проекту Actions. Системная команда
  - [changelog](#changelog) Команды работы с ChangeLog.md
    - [init](#changelog-init) Инициализировать ChangeLog.md
    - [convert](#changelog-convert) Конвертировать ChangeLog.md в другой формат
  - [checksum](#checksum) Выводит в консоль контрольную сумма файла или директории в формате md5
  - [ftp](#ftp) Команды для работы с FTP
    - [get](#ftp-get) Получение файлов с FTP-сервера
    - [put](#ftp-put) Отправка файлов на FTP-сервер
    - [delete](#ftp-delete) Удаление файлов на FTP-сервере
  - [json](#json) Команды для работы с json-файлами
    - [write](#json-write) Запись значения по ключу в файл json
  - [newsletter](#newsletter) Создание новостных рассылок через сторонние сервисы рассылок
    - [sendsay](#newsletter-sendsay) Работа с сервисом рассылок https://sendsay.ru
      - [newdraft](#newsletter-sendsay-newdraft) Выполняет отправку сформированного шаблона рассылки на сервис SendSay с использованием их API https://sendsay.ru/api/api.html
  - [obfuscation](#obfuscation) Обфускация (запутывание) кода на языке 1С
    - [module](#obfuscation-module) Обфускация общего модуля 1С:Предприятие 8
  - [zip](#zip) Команды работы с ZIP-архивами
    - [add](#zip-add) Добавить файлы в zip-архив
    - [extract](#zip-extract) Распаковать zip-архив

<!-- /TOC -->

## actions

Программная среда CI/CD для платформы 1С и не только. Позволяет выполнять сборку, доставку, тестирование ПО и многое из того, что может понадобиться в DevOps.

### Опции команды

- *version*: показать версию и выйти.
- *verbose*: Вывод отладочной информации в процессе выполнения.
Синонимы: [--verbose, -v].
- *settings*: Путь к файлу настроек (по умолчанию: ../env.json).
Синонимы: [--settings, -s].

### Как пользоваться библиотекой Actions?

Любую команду библиотеки *actions* можно выполнять следующим образом:

> **oscript** КОМАНДА --опция1 значение1 --опция2 значение2

**КОМАНДА** может состоять как из одного слова, так и из нескольких. Например команда: `zip add` - добавляет файлы/папки в архив, а `autodoc` генерирует эту документацию.

Примеры команд:

```cmd
# Узнаем версию
oscript --version
# Добавим текстовые файлы в архив
oscript zip add --file c:\temp\arc.zip --mask "c:\temp\file.txt;c:\temp\folder\*.txt"
# Скопируем файл архива на FTP
oscript ftp put --file c:\temp\arc.zip --server 192.168.1.10 --login admin --password 12345
```
Обратите внимание, в принципе, мы получили мини [Continuous Delivery (CD)](https://ru.wikipedia.org/wiki/Непрерывная_доставка) систему, которая заархиваировала некоторые файлы и отправила их на FTP :smile:

Это сильно притянуто за уши, но отражает суть. Библиотека позволяет 1С-нику (и не только) выполнять различные команды и под 

### Зачем мне использовать Actions?

*Вопрос*: Почему нельзя тоже самое сделать с помощью батников/bash?

*Ответ*: Библиотека работает на [OneScript](https://oscript.io) и ее можно быстро и привычно изменить под себя обычному 1С-специалисту.

Более того, с помощью этой библиотеки мы построили CI/CD систему на gitlab и полностью собираем из исходников EDT, тестируем, контролируем качество кода, готовим письма нашим клиентам, копируем релиз в облако S3 наше решение - конфигурацию на платформе 1С [Управление IT-отделом 8](https://softonit.ru/catalog/products/it/). Круто да?


---

### autodoc

Автоформирование документации по этому проекту Actions. Системная команда.

#### Опции команды

- *file*: Путь к файлу, куда сохранить документацию (обязательный).
Синонимы: [--file, -f].

---

### changelog

Команды работы с ChangeLog.md.

##### Что такое лог изменений?

ChangeLog — это файл, который содержит поддерживаемый, хронологически упорядоченный список значимых изменений для каждой версии проекта.

Формат основан на [Keep a Changelog](http://keepachangelog.com/) и этот проект придерживается [Semantic Versioning](http://semver.org/).

##### Зачем вести лог изменений?

Чтобы пользователям и контрибуторам было проще в точности понять, какие значимые изменения были внесены в каждый выпуск (или версию) проекта.

##### Кому нужен лог изменений?

Людям. Конечные пользователи программного обеспечения, будь то клиенты или разработчики, — это человеческие существа, которым небезразлично, с чем они работают. Когда программное обеспечение изменяется, люди хотят знать, что и почему изменилось.

##### Как мне сделать хороший лог-изменений?

###### Руководящие принципы

* Лог-изменений — для людей, а не для машин.
* Для каждой версии без исключения следует создать отдельный раздел.
* Однотипные изменения следует группировать.
* Следует предусмотреть возможность поставить ссылку на любую версию или раздел.
* Последняя версия должна идти в начале файла.
* Указаны даты выпуска каждой версии.

Уточните, следуете ли вы принципам семантического версионирования.

###### Типы изменений

* `Внимание!` — для чего-то важного, о чем стоит сказать отдельно.
* `Добавлено` — для новых функций.
* `Изменено` — для изменений в существующей функциональности.
* `Устарело` — для функций, которые скоро будут удалены.
* `Удалено` — для удалённых на данный момент функций.
* `Исправлено` — для любых исправлений багов.
* `Безопасность` — на случай уязвимостей.

Обратите внимание, что заголовки можно писать как на русском, так и на английском. Т.е. заголовки ниже взаимозаменяемы и являются синонимами:

* Внимание! и Attention! и Новости и News
* Добавлено и Added и Новый функционал
* Изменено и Changed и Изменения
* Устарело и Deprecated
* Исправление ошибок и Fixed и Замечания к обновлению
* Удалено и Removed
* Безопасность и Security

Т.е. можно написать так:

```markdown
## Изменено

* Изменено следующее 1
```

А можно вот так:

```markdown
## Changed

* Change next 1
```

Доступно полно форматирование markdown внутри заметок. Можно начинать строки с символа "*", а можно с "-".

#### Как мне тратить меньше усилий на ведение лога изменений?

Держите в начале файла раздел `Unreleased`, позволяющий отслеживать предстоящие изменения.

Это служит достижению двух целей:

1. Люди смогут видеть, каких изменений им можно ожидать в предстоящих выпусках;
2. В момент релиза вы можете переместить изменения из раздела `Unreleased` в раздел нового выпуска.

##### Пример файла CHANGELOG

```markdown
Продукт

# Changelog

Все изменения по проекту.

## [1.0.0.0] - 2023-06-15

### Внимание!

* Важная заметка 1 **жирный** *курсив*
* Важная заметка 2 ~~Зачеркнутый~~

### Добавлено

* Добавлено дело 1 ***жирный курсив***
* Добавлено дело 2 `выделенный`
* Картинка ![Описание](https://camo.githubusercontent.com/b0ae38dceb7087a93c566bcf5fd05b0e511edd3d523a290e0a9fe465b4c97df0/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d696e666f726d6174696f6e616c)
		
### Изменено

* Изменение 1 __снова жиный__ _снова курсив_
* Изменение 2

### Исправлено

* Исправление ошибки

### Безопасность

* Устранена критическая уязвимость

### Устарело

* Модуль "УдалитьОсновныеФункции" более не используется

### Удалено

* Справочник "УдалитьКонтактныеДанные" удален

```


---

#### changelog init

Инициализировать ChangeLog.md.

##### Опции команды

- *file*: Имя файла ChangeLog.md в формате MarkDown, который необходимо инициализировать.
Синонимы: [--file, -f].

##### Как инициализируется файл Changelog?

```markdown
# Changelog

Все изменения по проекту.

## [1.0.0.0] - 2023-06-08

### Внимание!

* Важная заметка 1 **жирный** *курсив*
* Важная заметка 2 ~~Зачеркнутый~~

### Добавлено

* Добавлено дело 1 ***жирный курсив***
* Добавлено дело 2 `выделенный`
* Картинка ![Описание](https://camo.githubusercontent.com/b0ae38dceb7087a93c566bcf5fd05b0e511edd3d523a290e0a9fe465b4c97df0/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d696e666f726d6174696f6e616c)

### Изменено

* Изменение 1 __снова жиный__ _снова курсив_
* Изменение 2

### Исправлено

* Исправление ошибки
```


---

#### changelog convert

Конвертировать ChangeLog.md в другой формат.

##### Опции команды

- *in*: Исходный файл ChangeLog.md в формате MarkDown из которого необходимо получить описание.
Синонимы: [--in, -i].
- *out*: Файл с новостью по обновлению из исходного файла в формате HTML или TXT в зависимости от расширения файла.
Синонимы: [--out, -o].
- *format*: Формат генерации документации. Поддерживается txt, html, htmlfull.
txt: Документация в формате TXT
html: Документация в кратком формате HTML. Все, что внутри тегов body
htmlfull: Документация в полном формате HTML. Готовый HTML-файл со всеми стилями и с полным оформлением
Синонимы: [--format, -f].
- *version*: Из какой версии будет получено описание. Если не задано, то будет получено по последней (необязательный).

##### Краткий HTML формат с параметром -format html

Выполняем команду changelog c `-format html` это создает **КРАТКИЙ** файл HTML без стилей. Т.е. шапка и подвал страницы не будут добавлены в итоговый файл:

```cmd
oscript src\actions.os changelog -file tests\fixtures\changelog.md -outfile tests\fixtures\changelog.html -format html
```

Получаем:

```html
<h3>Внимание!</h3>
<ul class="updnws">
<li>Важная заметка 1 <strong>жирный</strong> <em>курсив</em></li>
<li>Важная заметка 2 <del>Зачеркнутый</del></li>
</ul>
<h3>Добавлено</h3>
<ul class="updnew">
<li>Добавлено дело 1 <strong><em>жирный курсив</strong></em></li>
<li>Добавлено дело 2 <code>выделенный</code></li>
<li>Картинка <img src="https://camo.githubusercontent.com/b0ae38dceb7087a93c566bcf5fd05b0e511edd3d523a290e0a9fe465b4c97df0/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d696e666f726d6174696f6e616c" alt="Описание"></li>
</ul>
<h3>Изменено</h3>
<ul class="updedt">
<li>Изменение 1 <strong>снова жиный</strong> <em>снова курсив</em></li>
<li>Изменение 2</li>
</ul>
<h3>Исправлено</h3>
<ul class="upderr">
<li>Исправление ошибки</li>
</ul>
<h3>Безопасность</h3>
<ul class="updsec">
<li>Устранена критическая уязвимость</li>
</ul>
<h3>Устарело</h3>
<ul class="upddep">
<li>Модуль "УдалитьОсновныеФункции" более не используется</li>
</ul>
<h3>Удалено</h3>
<ul class="upddel">
<li>Справочник "УдалитьКонтактныеДанные" удален</li>
</ul>
<p></p>
```

##### Полный HTML формат с параметром -format htmlfull

Выполняем команду changelog c `-format htmlfull` это создает **ПОЛНЫЙ** файл HTML со всеми стилями. Т.е. шапка и подвал страницы будут добавлены в итоговый файл:

```cmd
oscript src\actions.os changelog -file tests\fixtures\changelog.md -outfile tests\fixtures\changelog.html -format htmlfull
```

Получаем:

```html
<!DOCTYPE html>
<html lang="ru">
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="theme-color" content="#EBF0F3" />
<title>1.0.0.0</title>
<style type="text/css">    
    ul.updsec, ul.upddep, ul.upddel, ul.updedt, ul.upderr, ul.updnew, ul.updnws {
        list-style: none;
        margin-left: 0;
        padding-left: 0;
        text-indent: -.3em;
        margin: 0 0 1rem 0;
    }
    
    ul.updsec li, ul.upddep li, ul.upddel li, ul.updnew li, ul.updedt li, ul.upderr li, ul.updnws li {
        position: relative;
        padding: 2px 0 0 30px;
        margin: 0 5px 5px 0;
    }

    ul.updsec li::before, ul.upddep li::before, ul.upddel li::before, ul.updnew li::before, ul.updedt li::before, ul.upderr li::before, ul.updnws li::before {
        content: "";
        position: absolute;
        top: 0.2em;
        left: 0;
        width: 16px;
        height: 16px;
    }

    .updsec li::before {
        background: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg id='_Слой_1' data-name='Слой 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cdefs%3E%3Cstyle%3E .cls-1 %7B fill: %23fff; %7D .cls-2 %7B fill: none; stroke: %23fff; stroke-miterlimit: 10; stroke-width: 1.81px; %7D .cls-3 %7B fill: %2308a652; %7D %3C/style%3E%3C/defs%3E%3Ccircle class='cls-3' cx='8' cy='8' r='8'/%3E%3Cg%3E%3Crect class='cls-1' x='3.48' y='6.38' width='9.03' height='6.62' rx='.87' ry='.87'/%3E%3Cpath class='cls-2' d='m7.98,3h0c1.32,0,2.39,1.07,2.39,2.39v3.32h-4.77v-3.32c0-1.32,1.07-2.39,2.39-2.39Z'/%3E%3Crect class='cls-3' x='7.37' y='7.84' width='1.26' height='3.16' rx='.63' ry='.63'/%3E%3C/g%3E%3C/svg%3E") no-repeat;
    }

    .upddep li::before {
        background: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg id='_Слой_1' data-name='Слой 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cdefs%3E%3Cstyle%3E .cls-1 %7B fill: %23fff; %7D .cls-2 %7B fill: %23c00; %7D %3C/style%3E%3C/defs%3E%3Ccircle class='cls-2' cx='8' cy='8' r='8'/%3E%3Ccircle class='cls-1' cx='8' cy='8' r='6.46'/%3E%3Cpath class='cls-2' d='m12.34,7.28c-.34-2.09-2.15-3.69-4.34-3.69s-4,1.6-4.34,3.69H.92v1.44h14.15v-1.44h-2.73Z'/%3E%3C/svg%3E") no-repeat;
    }

    .upddel li::before {
        background: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg id='_Слой_1' data-name='Слой 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cdefs%3E%3Cstyle%3E .cls-1 %7B fill: %23fff; %7D .cls-2 %7B fill: none; stroke: %23fff; stroke-miterlimit: 10; stroke-width: 1.8px; %7D .cls-3 %7B fill: %2308a652; %7D %3C/style%3E%3C/defs%3E%3Ccircle class='cls-3' cx='8' cy='8' r='8'/%3E%3Ccircle class='cls-2' cx='8' cy='8' r='5.5'/%3E%3Crect class='cls-1' x='2.59' y='6.99' width='10.83' height='2.03' transform='translate(-3.31 8) rotate(-45)'/%3E%3C/svg%3E") no-repeat;
    }

    .updnew li::before {
        background: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg id='_Слой_1' data-name='Слой 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cdefs%3E%3Cstyle%3E .cls-1 %7B fill: %23fff; %7D .cls-2 %7B fill: %2308a652; %7D %3C/style%3E%3C/defs%3E%3Ccircle class='cls-2' cx='8' cy='8' r='8'/%3E%3Ccircle class='cls-1' cx='8' cy='8' r='3.79'/%3E%3C/svg%3E") no-repeat;
    }
    
    .updedt li::before {
        background: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg id='_Слой_1' data-name='Слой 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cdefs%3E%3Cstyle%3E .cls-1 %7B fill: %23fff; %7D .cls-2 %7B fill: %2308a652; %7D %3C/style%3E%3C/defs%3E%3Ccircle class='cls-2' cx='8' cy='8' r='8'/%3E%3Ccircle class='cls-1' cx='8' cy='8' r='6.46'/%3E%3Ccircle class='cls-2' cx='8' cy='8' r='3.59'/%3E%3C/svg%3E") no-repeat;
    }
    
    .upderr li::before {
        background: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg id='_Слой_1' data-name='Слой 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cdefs%3E%3Cstyle%3E .cls-1 %7B fill: %23fff; %7D .cls-2 %7B fill: %23c00; %7D %3C/style%3E%3C/defs%3E%3Ccircle class='cls-2' cx='8' cy='8' r='8'/%3E%3Ccircle class='cls-1' cx='8' cy='8' r='3.79'/%3E%3C/svg%3E") no-repeat;
    }
    
    .updnws li::before {
        background: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg id='_Слой_1' data-name='Слой 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cdefs%3E%3Cstyle%3E .cls-1 %7B fill: %23fff; %7D .cls-2 %7B fill: %2308a652; %7D %3C/style%3E%3C/defs%3E%3Ccircle class='cls-2' cx='8' cy='8' r='8'/%3E%3Cg%3E%3Crect class='cls-1' x='7.28' y='3.85' width='1.57' height='5.7' rx='.78' ry='.78'/%3E%3Ccircle class='cls-1' cx='8.06' cy='11.42' r='.78'/%3E%3C/g%3E%3C/svg%3E") no-repeat;
    }
</style>
<BODY>
<h3>Внимание!</h3>
<ul class="updnws">
<li>Важная заметка 1 <strong>жирный</strong> <em>курсив</em></li>
<li>Важная заметка 2 <del>Зачеркнутый</del></li>
</ul>
<h3>Добавлено</h3>
<ul class="updnew">
<li>Добавлено дело 1 <strong><em>жирный курсив</strong></em></li>
<li>Добавлено дело 2 <code>выделенный</code></li>
<li>Картинка <img src="https://camo.githubusercontent.com/b0ae38dceb7087a93c566bcf5fd05b0e511edd3d523a290e0a9fe465b4c97df0/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d696e666f726d6174696f6e616c" alt="Описание"></li>
</ul>
<h3>Изменено</h3>
<ul class="updedt">
<li>Изменение 1 <strong>снова жиный</strong> <em>снова курсив</em></li>
<li>Изменение 2</li>
</ul>
<h3>Исправлено</h3>
<ul class="upderr">
<li>Исправление ошибки</li>
</ul>
<h3>Безопасность</h3>
<ul class="updsec">
<li>Устранена критическая уязвимость</li>
</ul>
<h3>Устарело</h3>
<ul class="upddep">
<li>Модуль "УдалитьОсновныеФункции" более не используется</li>
</ul>
<h3>Удалено</h3>
<ul class="upddel">
<li>Справочник "УдалитьКонтактныеДанные" удален</li>
</ul>
<p></p>

</BODY>
</HTML>
```

Этот файл можно открыть и он будет отображать красивые значки.

##### Текстовый формат -format txt

Выполняем команду changelog для получения текстового :

```cmd
oscript src\actions.os changelog -file tests\fixtures\changelog.md -outfile tests\fixtures\changelog.txt -format txt
```

Получаем текстовое описание файла changelog.md описанного выше:

```
[!] Важная заметка 1 [b]жирный[/b] [i]курсив[/i]
[!] Важная заметка 2 [s]Зачеркнутый[/s]
[+] Добавлено дело 1 [b][i]жирный курсив[/b][/i]
[+] Добавлено дело 2 [code]выделенный[/code]
[+] Картинка [img]https://camo.githubusercontent.com/b0ae38dceb7087a93c566bcf5fd05b0e511edd3d523a290e0a9fe465b4c97df0/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d696e666f726d6174696f6e616c[/img]
[*] Изменение 1 [b]снова жиный[/b] [i]снова курсив[/i]
[*] Изменение 2
[-] Исправление ошибки
[S] Устранена критическая уязвимость
[D] Модуль "УдалитьОсновныеФункции" более не используется
[R] Справочник "УдалитьКонтактныеДанные" удален
```


---

### checksum

Выводит в консоль контрольную сумма файла или директории в формате md5.

#### Опции команды

- *file*: Исходный файл или директория (обязательный).
Синонимы: [--file, -f].
- *mask*: Маска файлов для контрольной суммы, используется если указана директория.
Если параметр не задан для директории, то контрольная сумма будет сформирована по всем файлам (необязательный).
Синонимы: [--mask, -m].
Значение по умолчанию: "*".

#### Зачем нужна эта команда?

Контрольая сумма по файлу/директории позволяет получить строку, которая будет не изменна для файлов, пока они не изменятся.
Это может пригодится для того, чтобы понять надо ли собирать по новой проект или нет (изменялись ли файлы в папке или нет).

Например, в pipeline мы можем сохранять собранный проект 1C в хранилище сборок вида:

```ini
06ead29bfa5dfa3d4cce226854d412ea=С:\Builder\06ead29bfa5dfa3d4cce226854d412ea\config.cf
```

Далее, в начале сборки pipeline смотрим надо ли собирать проект из исходников EDT? Для этого:

1. Считаем по директории контрольную сумму
2. Смотрим есть ли в хранилище сборок база с такой контрольной суммой
2.1. Если *Да* - берем эту базу из хранилища сборок и не собираем из проект EDT конфигурацию.
2.2. Если *Нет* - собираем проект EDT в конфигурацию cf, сохрнаяем ее в хранилище сборок, где присваиваем сборке контрольную сумму.
3. При повторных сборках когда не меняется конфигурация, мы будем экономить время на сборку.

> **Внимание!** Следует с осторожностью относится к директориям где находится очень много больших файлов. В таких каталогах контрольная сумма будет рассчитываться не быстро. Имейте это ввиду.


---

### ftp

Команды для работы с FTP.

---

#### ftp get

Получение файлов с FTP-сервера.

##### Опции команды

- *server*: Имя FTP-сервера (обязательный).
- *login*: Логин FTP-сервера. По умолчанию "anonymous" (необязательный).
Синонимы: [--login, -l].
- *password*: Пароль FTP-сервера. По умолчанию "anonymous" (необязательный).
Синонимы: [--password, -p].
- *port*: Порт на FTP-сервере. Если не указано, то будет использован 21 порт (необязательный).
- *timeout*: Таймаут подключения к FTP-серверу. По умолчанию - 30 секунд (необязательный).
Синонимы: [--timeout, -t].
- *remote*: Имя директории на FTP-сервере, что необходимо получить. Если не указано, то будет использован корневой путь "/" (необязательный).
Синонимы: [--remote, -r].
- *mask*: Маска файлов для скачивания. Если не указана, то используется маска "*" (необязательный). Пример: *.txt.
Синонимы: [--mask, -m].
- *local*: Директория на локальном компьютере куда необходимо загрузить файлы (обязательный). Пример: "C:\Path\File.txt", "C:\Path\".
- *recursive*: Флаг рекурсивного копирования файлов с FTP-сервера (необязательный). По умолчанию копирование выполняется только с указанной на сервере директории.
Синонимы: [--recursive, -r].

---

#### ftp put

Отправка файлов на FTP-сервер.

##### Опции команды

- *server*: Имя FTP-сервера (обязательный).
- *login*: Логин FTP-сервера. По умолчанию "anonymous" (необязательный).
Синонимы: [--login, -l].
- *password*: Пароль FTP-сервера. По умолчанию "anonymous" (необязательный).
Синонимы: [--password, -p].
- *port*: Порт на FTP-сервере. Если не указано, то будет использован 21 порт (необязательный).
- *timeout*: Таймаут подключения к FTP-серверу. По умолчанию - 30 секунд (необязательный).
Синонимы: [--timeout, -t].
- *local*: Директория из которой будут отправляться файлы на FTP-сервер на локальном компьютере (обязательный).
Пример: C:\Path\.
- *mask*: Маска файлов для отправки на сервер. Если не указана, то используется маска "*" (необязательный). Пример: *.txt.
Синонимы: [--mask, -m].
- *remote*: Имя директории на FTP-сервере, куда необходимо сохранить отправляемые файлы (необязательный).
Если не указано, то будет сохранено в корень "/".
Синонимы: [--remote, -r].
- *recursive*: Флаг рекурсивного копирования файлов на FTP-сервер (необязательный). По умолчанию копирование выполняется только с локальной директории.
Синонимы: [--recursive, -r].

---

#### ftp delete

Удаление файлов на FTP-сервере.

##### Опции команды

- *server*: Имя FTP-сервера (обязательный).
- *login*: Логин FTP-сервера. По умолчанию "anonymous" (необязательный).
Синонимы: [--login, -l].
- *password*: Пароль FTP-сервера. По умолчанию "anonymous" (необязательный).
Синонимы: [--password, -p].
- *port*: Порт на FTP-сервере. Если не указано, то будет использован 21 порт (необязательный).
- *timeout*: Таймаут подключения к FTP-серверу. По умолчанию - 30 секунд (необязательный).
Синонимы: [--timeout, -t].
- *remote*: Имя директории на FTP-сервере, что необходимо получить. Если не указано, то будет использован корневой путь "/" (необязательный).
Синонимы: [--remote, -r].
- *mask*: Маска файлов для скачивания. Если не указана, то используется маска "*" (необязательный). Пример: *.txt.
Синонимы: [--mask, -m].

---

### json

Команды для работы с json-файлами.

---

#### json write

Запись значения по ключу в файл json.

##### Опции команды

- *key*: Имя ключа в точечной нотации. Пример "zip.add" - добавит {"zip": {"add": "value"}} (обязательный).
Синонимы: [--key, -k].
- *string*: Значение-строка.
Синонимы: [--string, --str, -s].
- *number*: Значение-число.
Синонимы: [--number, --num, -n].
- *boolean*: Значение-булево (True/False, 1/0, Истина/Ложь).
Синонимы: [--boolean, --bool, -b].
- *date*: Значение-дата в формате yyyy-MM-dd_HH:mm:ss.
Синонимы: [--date, -d].
- *file*: Имя файла json. Если не задано, то будет дозапись в файл settings.json.
Если файла нет, он будет создан (не обязательный).
Синонимы: [--file, -f].

Записываемое значение может быть различных типов.

1. Записываем строку. Приоритет 1:
    ```bash
    oscript actions.os json write --key "add.zip" --string "Привет мир"
    ```
2. Записываем число. Приоритет 2:
    ```bash
    oscript actions.os json write --key "add.zip" --number 555
    ```
3. Записываем булево. Приоритет 3:
    ```bash
    # Присваиваем Истина
    oscript actions.os json write --key "add.zip" --boolean true
    oscript actions.os json write --key "add.zip" --boolean 1    
    oscript actions.os json write --key "add.zip" --boolean Истина
    # Присваиваем Ложь
    oscript actions.os json write --key "add.zip" --boolean false
    oscript actions.os json write --key "add.zip" --boolean 0
    oscript actions.os json write --key "add.zip" --boolean Ложь
    ```
4. Записываем дату. Приоритет 4:
    ```bash
    oscript actions.os json write --key "add.zip" --date 2023-06-05_23:59:59
    ```
    
> **Важно!** Если указать несколько значений у одного ключа одновременно (пример: *"--key "add.zip" --boolean 1 --number 555"*), то значение установится по приоритету указанному выше, в примерах (1-4).


---

### newsletter

Создание новостных рассылок через сторонние сервисы рассылок.

---

#### newsletter sendsay

Работа с сервисом рассылок https://sendsay.ru.

---

##### newsletter sendsay newdraft

Выполняет отправку сформированного шаблона рассылки на сервис SendSay с использованием их API https://sendsay.ru/api/api.html.

###### Опции команды

- *account*: Код вашего аккаунта (совпадает с основным логином) (обязательный).
Синонимы: [--account, --acc].
- *apikey*: Секретный API-ключ, пользователя SendSay, по которому будет осуществлена авторизация в API (обязательный).
Синонимы: [--apikey, -a].
- *segment*: Идентификатор сегмента получателей рассылки (обязательный).
Синонимы: [--segment, --seg].
- *templateid*: Идентификатор шаблона рассылки, который необходимо изменить (обязательный).
Синонимы: [--templateid, --tid].
- *templatename*: Наименование шаблона рассылки (обязательный).
Синонимы: [--templatename, --tname].
- *templatehtml*: Локальный путь к файлу готового шаблона рассылки в формате HTML и в кодировке UTF-8 (обязательный).
Синонимы: [--templatehtml, --html].
- *subject*: Тема письма (не обязательный).
Синонимы: [--subject, --sub].
- *from*: От имени кого будет отправлено письмо (обязательный).
- *email*: С какого e-mail будет отправлено письмо (обязательный).

---

### obfuscation

Обфускация (запутывание) кода на языке 1С.

#### Зачем нужна обфускация в 1С?

**Обфускация** или запутывание кода — приведение исходного кода или исполняемого кода программы к виду, сохраняющему её функциональность, но затрудняющему анализ, понимание алгоритмов работы и модификацию при декомпиляции.

Обфускация используется для защиты конфигураций 1С, в частности общих модулей.

Приведем наглядный пример. Пусть у нас есть модуль, который содержит функцию возвращающуу массив простых чисел:

```bsl
// Возвращает массив простых чисел от 1 до максимального.
//
// Параметры:
//	МаксимальноеЧисло - Число - до этого числа будет строится массив.
//
// Возвращаемой значение:
//	Массив - массив простых чисел.
//
Функция МассивПростыхЧисел(Знач МаксимальноеЧисло) Экспорт
	
	Результат = Новый Массив;
	Для ПроверяемоеЧисло = 1 По МаксимальноеЧисло Цикл
							
		ВерхняяГраницаПроверки = ПроверяемоеЧисло - 1;
		ЭтоПростоеЧисло = Истина;
		Для Индекс = 2 По ВерхняяГраницаПроверки Цикл
			Если ПроверяемоеЧисло % Индекс = 0 Тогда
				ЭтоПростоеЧисло = Ложь;
				Прервать;
			КонецЕсли;
		КонецЦикла;
		
		Если ЭтоПростоеЧисло Тогда
			Результат.Добавить(ПроверяемоеЧисло);
		КонецЕсли;
	КонецЦикла;
	
	Возврат Результат;
	
КонецФункции
```

Выполняем команду в консоли (в папке src)

```cmd
oscript actions.os obfuscation -file c:\Temp\ПростыеЧисла.bsl -outfile c:\Temp\ПростыеЧислаОбфусцированный.bsl -APIKey 4447C4CB6DDFF7597277904444F8F024945DB382993D1A9403F27F4760B19B719662424EE1AAA34A85C0444D828CB8F54433F82BC8448185F915E9B8768DEBDF
```

И получаем обфусцированный файл:

```bsl
function массивпростыхчисел(val a)export var ___a; ~0:; _0=1; _0=-_0; _1=1; _0=_0>=_1; if _0=false then goto ~IL_0 endif; goto ~2; ~IL_0:; goto ~1; ~1:; goto ~3; ~2:; ~3:; _0=new массив; a_=_0; goto ~5; ~4:; _0=new структура; a_=_0; goto ~5; ~5:; _0=1; a__=_0; _0=a; _e96099e2_1fdd_449a_af14_28f4abb97b25=_0; goto ~IL_2; ~IL_3:; ~6:; _0=1; _1=0; _0=_0<=_1; if _0=false then goto ~IL_5 endif; goto ~7; ~IL_5:; goto ~10; ~7:; ~8:; _0=a__; _1=1; _0=_0-_1; a___=_0; goto ~11; ~9:; goto ~11; ~10:; goto ~8; ~11:; ~12:; _0=0; ___a=_0; goto ~13; ~13:; _0=истина; _a=_0; goto ~15;
~14:; goto ~15; ~15:; _0=2; __a=_0; _0=a___; _9f91b140_1943_4368_8052_23db0ec59cb7=_0; goto ~IL_7; ~IL_8:; ~16:; _0=1; ___a=_0; goto ~18; ~17:; goto ~19; ~18:; _0=a__; _1=__a; _0=_0%_1; _1=0; _0=_0=_1; if _0=false then goto ~IL_10 endif; goto ~20; ~IL_10:; goto ~19; ~19:; goto ~31; ~20:; ~21:; _0=1; _1=0; _0=_0>_1; if _0=false then goto ~IL_11 endif; goto ~23; ~IL_11:; goto ~24; ~22:; _0=ложь; _a=_0; goto ~26; ~23:; goto ~22; ~24:; ~25:; goto ~26; ~26:; ~27:; _0=1; ___a=_0; goto ~28; ~28:; goto ~IL_6; goto ~30; ~29:; goto ~30; ~30:; goto ~31; ~31:; ~IL_9:; _0=__a; _1=1;
_0=_0+_1; __a=_0; ~IL_7: _0=__a; _1=_9f91b140_1943_4368_8052_23db0ec59cb7; if _0<=_1 then goto ~IL_8 endif; ~IL_6:; ~32:; _0=0; ___a=_0; goto ~33; ~33:; _0=_a; if _0=false then goto ~IL_12 endif; goto ~36; ~IL_12:; goto ~35; ~34:; goto ~35; ~35:; goto ~41; ~36:; ~37:; _0=1; _0=-_0; ___a=_0; goto ~39; ~38:; goto ~40; ~39:; a_.добавить(a__); goto ~40; ~40:; goto ~41; ~41:; ~IL_4:; _0=a__; _1=1; _0=_0+_1; a__=_0; ~IL_2: _0=a__; _1=_e96099e2_1fdd_449a_af14_28f4abb97b25; if _0<=_1 then goto ~IL_3 endif; ~IL_1:; ~42:; _0=1; _1=1; _1=-_1; _0=_0<=_1; if _0=false then goto ~IL_13 endif;
goto ~44; ~IL_13:; goto ~43; ~43:; goto ~46; ~44:; ~45:; goto ~47; ~46:; _0=a_; return _0; goto ~47; ~47:; endfunction 
```

Вставив обфусцированный модуль вместо старого модуля получим точно такую же работающую функцию.


---

#### obfuscation module

Обфускация общего модуля 1С:Предприятие 8.

##### Опции команды

- *in*: Исходный файл, который необходимо обфусцировать (обязательный).
Синонимы: [--in, -i].
- *out*: Куда сохранить обфусцированный файл. Если не задан, то исходный файл будет заменен обфусцированным (необязательный).
Синонимы: [--out, -o].
- *apikey*: API-ключ, который можно найти на сайте сервиса. Пример: 23412341A4..12FDA (обязательный).
Синонимы: [--apikey, -a].

---

### zip

Команды работы с ZIP-архивами.

---

#### zip add

Добавить файлы в zip-архив.

##### Опции команды

- *file*: Полное имя файла создаваемого zip-архива (обязательный).
Синонимы: [--file, -f].
- *mask*: Файлы и папки, включаемые в архив. Можно использовать разделитель ";" и маски файлов (обязательный).
 Примеры:
   "C:\Path\File1.txt|C:\Path\Folder"
   "C:\Path\*.txt;C:\Path\Folder\*.*"
   "C:\Path\Folder".
Синонимы: [--mask, -m].

---

#### zip extract

Распаковать zip-архив.

##### Опции команды

- *file*: Полное имя файла zip-архива для распаковки (обязательный).
Синонимы: [--file, -f].
- *path*: Директория куда необходимо распаковать архив (обязательный).
Синонимы: [--path, -p].

---

